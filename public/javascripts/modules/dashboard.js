// Generated by CoffeeScript 1.10.0
(function() {
  define(["corejs", "ng-route", "ng-fire"], function(Core, ng_route, ng_fire) {
    return Core.register("dashboard", function(sandbox) {
      return {
        init: function() {
          console.log("Starting dashboard...");
          return sandbox.listen("config-data", this.runDashboard);
        },
        runDashboard: function(data) {
          var angular, app, href;
          href = data.config.db;
          angular = sandbox.use("angular");
          if (!angular) {
            this.destroy();
          }
          app = angular.module("dashboard", ["ngRoute", "firebase"]);
          app.config(function($routeProvider) {
            return $routeProvider.when("/", {
              templateUrl: "dashboard.html"
            }).when("/api/v0.1/test/:value", {
              redirectTo: function(routeParams, path, search) {
                var value, version;
                value = routeParams.value;
                version = path.split("/")[2];
                sandbox.notify({
                  type: "db-act",
                  data: {
                    mode: "push",
                    location: "api/test",
                    info: {
                      value: routeParams.value,
                      version: version,
                      search: search
                    }
                  }
                });
                console.log(value, version, search);
                return "/";
              }
            }).when("/data/test", {
              templateUrl: "datatest.html",
              controller: "DataTestCtrl"
            }).otherwise({
              templateUrl: "otherwise.html"
            });
          });
          app.factory("testEntries", function($firebaseArray) {
            var ref;
            ref = new Firebase(href + "api/test");
            return $firebaseArray(ref);
          });
          app.controller("DataTestCtrl", function($scope, testEntries) {
            return $scope.test = {
              entries: testEntries
            };
          });
          return angular.bootstrap(document, ["dashboard"]);
        },
        destroy: function() {
          return console.log("Stopping dashboard...");
        }
      };
    });
  });

}).call(this);
