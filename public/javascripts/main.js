// Generated by CoffeeScript 1.10.0
(function() {
  require.config({
    urlArgs: "nocache=" + (new Date).getTime(),
    paths: {
      "jquery": "../vendor/jquery/dist/jquery.min",
      "corejs": "../vendor/corejs/core.min",
      "firebase": "../vendor/firebase/firebase"
    },
    shim: {
      "firebase": {
        exports: "Firebase"
      }
    }
  });

  require(["jquery", "firebase", "corejs", "modules/canvas", "modules/draw", "modules/database"], function(jQuery, Firebase, Core, mod_canvas, mod_draw, mod_database) {
    Core.extend("$", jQuery);
    Core.extend("db", Firebase);
    Core.register("main", function(sandbox) {
      return {
        init: function() {
          var $, self;
          console.log("Starting main...");
          $ = sandbox.use("$");
          self = this;
          return $(document).ready(function() {
            Core.start("canvas");
            Core.start("draw");
            Core.start("database");
            return $.get("javascripts/config.json", function(config) {
              var db_time;
              self.config = config;
              sandbox.notify({
                type: "db-setup",
                data: {
                  name: self.config.db
                }
              });
              db_time = function() {
                return sandbox.notify({
                  type: "db-act",
                  data: {
                    mode: "push",
                    location: "time",
                    info: {
                      now: Date.now()
                    }
                  }
                });
              };
              return self.delay(db_time, 1000);
            });
          });
        },
        delay: function(func, time) {
          return setTimeout(func, time);
        },
        destroy: function() {
          return console.log("Stopping main...");
        }
      };
    });
    return Core.start("main");
  });

}).call(this);
